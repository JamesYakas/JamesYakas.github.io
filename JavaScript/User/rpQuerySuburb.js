Backendless.serverURL="https://api.backendless.com",Backendless.initApp("073669A8-CCB7-2AED-FFEC-841A4CE5F400","FAFDE171-5308-49CF-9980-AA89E4F28F0C");var suburb=localStorage.getItem("usersSuburb"),initialSearch=!0,_typeOfSpecial=["Drink"],masterEstablishments=[],masterMarkers=[],filteredMarkers=[],useFilteredMarkers=!1,lat=0,lng=0,state="filtered-list";function pageOnLoad(){if(!initialSearch){useFilteredMarkers=!1,$("#daysOfWeekFilter").val("");var e=document.getElementById("daysOfWeekFilter");e.options[0]=new Option("Any",""),e.options[0].disabled=!0,document.getElementById("timePeriodStartFilter").selectedIndex="0",document.getElementById("timePeriodEndFilter").selectedIndex="16",$("#specialCategoryFilter").val("");var t=document.getElementById("specialCategoryFilter");t.options[0]=new Option("Any",""),t.options[0].disabled=!0;for(r=0,n={},i=["Breakfast Special","Lunch Special","Dinner Special","Happy Hour"],o=0;o<i.length;o++)n[i[o]]=o;var s=Backendless.DataQueryBuilder.create();return s.setRelated(["establishmentSpecials"]),s.setWhereClause("Suburb = '"+suburb+"'"),Backendless.Data.of("Establishment").find(s).then(function(e){document.getElementById("rpList").innerHTML="";for(var t=["Drink"],s=e.reduce((e,s)=>{const l=s.establishmentSpecials.filter(e=>t.includes(e.Type_Of_Special));return l.length>0?[...e,{...s,establishmentSpecials:l}]:e},[]),l=0;l<s.length;l++)if(console.log(s),s[l].establishmentSpecials.length>0){s[l].establishmentSpecials.sort(function(e,t){return n[e.Category]-n[t.Category]||e.Start_Time.localeCompare(t.Start_Time)}),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+s[l].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+s[l].Image+'"><br><span class="est-name">'+s[l].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\'  class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s[l].objectId+'"></tbody></table></div>';for(var a=0;a<s[l].establishmentSpecials.length;a++){var i,o=document.getElementById("myTable"+s[l].objectId);i=s[l].establishmentSpecials[a].Days_Of_Week.split(", "),console.log(i);for(var c="M",d="T",m="W",p="T",g="F",u="S",b="S",h=0;h<i.length;h++)"Monday"==i[h]?c=c.fontcolor("#E63594"):"Tuesday"==i[h]?d=d.fontcolor("#E63594"):"Wednesday"==i[h]?m=m.fontcolor("#E63594"):"Thursday"==i[h]?p=p.fontcolor("#E63594"):"Friday"==i[h]?g=g.fontcolor("#E63594"):"Saturday"==i[h]?u=u.fontcolor("#E63594"):"Sunday"==i[h]&&(b=b.fontcolor("#E63594"));addRowTopSpecial(o,'<img class="cocktail-small-img" src="images/cocktail-small.png">'+s[l].establishmentSpecials[a].Description,s[l].establishmentSpecials[a].objectId),addRowBottom(o,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(s[l].establishmentSpecials[a].Start_Time)+" - "+tConvert(s[l].establishmentSpecials[a].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+c+d+m+p+g+u+b+"</div>",s[l].establishmentSpecials[a].objectId),r++}document.getElementById("rpList").innerHTML+="<br>"}var y=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var f=0,S=e.length,E=[],v=0;for(f=0;f<S;f++){var k=!1;for(v=0;v<e[f].establishmentSpecials.length;v++)if("Food"==e[f].establishmentSpecials[v].Type_Of_Special){console.log(e[f].Name),k=!0;break}if(1==k){if(e[f].Cuisine_Type.includes(", ")){var I=e[f].Cuisine_Type;console.log(I);for(var T=I.split(", "),M=0,C=T.length;M<C;M++)E.push(T[M]);console.log(T)}else E.push(e[f].Cuisine_Type);0}}var B=E.filter(onlyUnique);B.sort();var _,F=1,L=0,O=B.length;for(L=0;L<O;L++)y.options[0]=new Option("Any",""),y.options[0].disabled=!0,y.options[F]=new Option(B[L],B[L]),F++;drinkFoodVisuals("drink"),_typeOfSpecial=["Drink"],masterEstablishments=e,console.log(e),document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+r+"' matching Drink specials",_=e.length>0?e[0].Postcode:"No results",document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+_+"</span>","block"==document.getElementById("rpGoogleMap").style.display&&(document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"),document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),console.log("1. Populate list")}).then(()=>{var e,t=suburb;return e=null!=masterEstablishments[0]?"https://maps.googleapis.com/maps/api/geocode/json?components=country:"+masterEstablishments[0].Country:"https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",axios.get(e,{params:{address:t,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){lat=e.data.results[0].geometry.location.lat,lng=e.data.results[0].geometry.location.lng,console.log("2. Get suburb coords")}).then(()=>{console.log("3. Start map markers creation");for(var e=0;e<masterEstablishments.length;e++)if(masterEstablishments[e].establishmentSpecials.length>0){console.log("4.1 Start creating a single marker");masterMarkers.push({coords:{lat:masterEstablishments[e].Location.y,lng:masterEstablishments[e].Location.x},iconImage:"images/restaurant.png",content:masterEstablishments[e].Name+"<br>"+masterEstablishments[e].Cuisine_Type+"<br>"+masterEstablishments[e].Address+"<br>",Cuisine_Type:masterEstablishments[e].Cuisine_Type,establishmentSpecials:masterEstablishments[e].establishmentSpecials}),console.log("4.2 Finish creating a single marker")}console.log("5. Finish map markers creation")}).then(()=>{console.log("6. Initialize map")})}).catch(function(e){})}var l=sessionStorage.getItem("suburbResults"),a=JSON.parse(l);document.getElementById("rpList").innerHTML="";for(var n={},i=["Breakfast Special","Lunch Special","Dinner Special","Happy Hour"],o=0;o<i.length;o++)n[i[o]]=o;for(var r=0,c=["Drink"],d=a.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>c.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]),o=0;o<d.length;o++)if(d[o].establishmentSpecials.length>0){d[o].establishmentSpecials.sort(function(e,t){return n[e.Category]-n[t.Category]||e.Start_Time.localeCompare(t.Start_Time)}),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+d[o].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+d[o].Image+'"><br><span class="est-name">'+d[o].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+d[o].objectId+'"></tbody></table></div>';for(var m=0;m<d[o].establishmentSpecials.length;m++){var p,g=document.getElementById("myTable"+d[o].objectId);p=d[o].establishmentSpecials[m].Days_Of_Week.split(", ");for(var u="M",b="T",h="W",y="T",f="F",S="S",E="S",v=0;v<p.length;v++)"Monday"==p[v]?u=u.fontcolor("#E63594"):"Tuesday"==p[v]?b=b.fontcolor("#E63594"):"Wednesday"==p[v]?h=h.fontcolor("#E63594"):"Thursday"==p[v]?y=y.fontcolor("#E63594"):"Friday"==p[v]?f=f.fontcolor("#E63594"):"Saturday"==p[v]?S=S.fontcolor("#E63594"):"Sunday"==p[v]&&(E=E.fontcolor("#E63594"));addRowTopSpecial(g,'<img class="cocktail-small-img" src="images/cocktail-small.png">'+d[o].establishmentSpecials[m].Description,d[o].establishmentSpecials[m].objectId),addRowBottom(g,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(d[o].establishmentSpecials[m].Start_Time)+" - "+tConvert(d[o].establishmentSpecials[m].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+u+b+h+y+f+S+E+"</div>",d[o].establishmentSpecials[m].objectId),r++}document.getElementById("rpList").innerHTML+="<br>"}var k=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var I=0,T=a.length,C=[],B=0;for(I=0;I<T;I++){var _=!1;for(B=0;B<a[I].establishmentSpecials.length;B++)if("Food"==a[I].establishmentSpecials[B].Type_Of_Special){console.log(a[I].Name),_=!0;break}if(1==_){if(a[I].Cuisine_Type.includes(", ")){var F=a[I].Cuisine_Type;console.log(F);for(var L=F.split(", "),O=0,w=L.length;O<w;O++)C.push(L[O]);console.log(L)}else C.push(a[I].Cuisine_Type);0}}console.log(C);var j=C.filter(onlyUnique);j.sort(),console.log(j);var D=1,H=0,A=j.length;for(H=0;H<A;H++)k.options[0]=new Option("Any",""),k.options[0].disabled=!0,k.options[D]=new Option(j[H],j[H]),D++;var R,W=document.querySelectorAll("#foodDrink");M.Tabs.init(W,{duration:100}),masterEstablishments=a,R=d.length>0?d[0].Postcode:"No results",document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+R+"</span>",console.log("1. Populate list"),document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+r+"' matching Drink specials",document.getElementById("rpbtnList").style.backgroundColor="#E63594";W=document.querySelectorAll("select");if(M.FormSelect.init(W),console.log("State: "+state),initialSearch){var N,G=suburb;return N=null!=masterEstablishments[0]?"https://maps.googleapis.com/maps/api/geocode/json?components=country:"+masterEstablishments[0].Country:"https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",axios.get(N,{params:{address:G,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){lat=e.data.results[0].geometry.location.lat,lng=e.data.results[0].geometry.location.lng,console.log("2. Get suburb coords")}).then(()=>{console.log("3. Start map markers creation");for(var e=0;e<masterEstablishments.length;e++)if(masterEstablishments[e].establishmentSpecials.length>0){console.log("4.1 Start creating a single marker");masterMarkers.push({coords:{lat:masterEstablishments[e].Location.coordinates[1],lng:masterEstablishments[e].Location.coordinates[0]},iconImage:"images/restaurant.png",content:masterEstablishments[e].Name+"<br>"+masterEstablishments[e].Cuisine_Type+"<br>"+masterEstablishments[e].Address,Cuisine_Type:masterEstablishments[e].Cuisine_Type,establishmentSpecials:masterEstablishments[e].establishmentSpecials,objectId:masterEstablishments[e].objectId}),console.log("4.2 Finish creating a single marker")}console.log("5. Finish map markers creation")}).catch(function(e){}).then(()=>{console.log("6. Initialize map")})}}function initMap(){console.log("7. Map Initialization started");var e={zoom:13,center:{lat:lat,lng:lng}};console.log("8. Start print markers"),console.log("9. End print markers");var t,s=new google.maps.Map(document.getElementById("rpGoogleMap"),e);if(console.log("Running first time"),console.log("10. Map created"),console.log("10.1 clear markers"),console.log(useFilteredMarkers),0==useFilteredMarkers)for(var l=0;l<masterMarkers.length;l++)a(masterMarkers[l]);else for(l=0;l<filteredMarkers.length;l++)a(filteredMarkers[l]);function a(e){var l=new google.maps.Marker({position:e.coords,map:s,Cuisine_Type:e.Cusine_Type,establishmentSpecials:e.establishmentSpecials,objectId:e.objectId});if(e.iconImage&&l.setIcon(e.iconImage),e.content){var a=new google.maps.InfoWindow({content:e.content});l.addListener("click",function(){t&&t.close(),a.open(s,l),t=a})}}console.log("11. Markers added")}function setMapOnAll(e){for(var t=0;t<filteredMarkers.length;t++)filteredMarkers[t].setMap(e)}function clearMarkers(){setMapOnAll(null),filteredMarkers=[]}function deleteMarkers(){for(var e=0;e<filteredMarkers.length;e++)filteredMarkers[e].setMap(null);filteredMarkers=[]}function daysOfWeekFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters()}function timePeriodFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters()}function specialCategoryFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters()}function cusineTypeFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters()}function establishmentTypeFilter(){state="filtered-list",console.log("State: "+state),applyFilters()}function typeOfSpecialFilterDrink(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),_typeOfSpecial=["Drink"],state="filtered-list",console.log("State: "+state),applyFilters(),drinkFoodVisuals("drink")}function typeOfSpecialFilterFood(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect(),_typeOfSpecial=["Food"],state="filtered-list",console.log("State: "+state),applyFilters(),drinkFoodVisuals("food")}function applyFilters(){var e=$("#daysOfWeekFilter").val(),t=$("#timePeriodStartFilter").val(),s=$("#timePeriodEndFilter").val(),l=$("#specialCategoryFilter").val(),a=$("#cusineTypeFilter").val(),n=_typeOfSpecial;console.log(n);for(var i=masterEstablishments,o=[],r=0;r<i.length;r++)for(var c=0;c<i[r].establishmentSpecials.length;c++){var d=[];if(i[r].establishmentSpecials[c].Days_Of_Week.includes(", "))for(var m=i[r].establishmentSpecials[c].Days_Of_Week.split(", "),p=0,g=m.length;p<g;p++)d.push(m[p]);else d.push(i[r].establishmentSpecials[c].Days_Of_Week);for(var u=0;u<e.length;u++)1==d.includes(e[u])&&o.push(i[r].establishmentSpecials[c].objectId)}console.log(o),e.length>=1&&o.length>=0&&(i=i.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>o.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var b=60*t.substring(0,2)+ +t.substring(3,5),h=60*s.substring(0,2)+ +s.substring(3,5),y=[],f=[];for(r=0;r<i.length;r++)for(c=0;c<i[r].establishmentSpecials.length;c++){var S=i[r].establishmentSpecials[c].Start_Time,E=i[r].establishmentSpecials[c].End_Time;S=60*S.substring(0,2)+ +S.substring(3,5),(E=60*E.substring(0,2)+ +E.substring(3,5))>b&&S<h&&(y.push(i[r].establishmentSpecials[c]),f.push(i[r].establishmentSpecials[c].objectId))}if(f.length>=0&&(i=i.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>f.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(i=i.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var v=[],k=[];for(r=0;r<i.length;r++){var I=[];if(i[r].Cuisine_Type.includes(", ")){var T=i[r].Cuisine_Type.split(", ");for(p=0,g=T.length;p<g;p++)I.push(T[p])}else I.push(i[r].Cuisine_Type);for(u=0;u<a.length;u++)1==I.includes(a[u])&&(k.push(i[r]),v.push(i[r].objectId))}console.log(k),console.log(a),console.log(v),a.length>=1&&(i=i.filter(e=>v.includes(e.objectId)))}n.length>=1&&(i=i.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>n.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var M={},C=["Breakfast Special","Lunch Special","Dinner Special","Happy Hour"];for(r=0;r<C.length;r++)M[C[r]]=r;var B=0;if("establishment-page-map"!=state){document.getElementById("rpList").innerHTML="";for(r=0;r<i.length;r++){i[r].establishmentSpecials.sort(function(e,t){return M[e.Category]-M[t.Category]||e.Start_Time.localeCompare(t.Start_Time)}),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+i[r].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+i[r].Image+'"><br><span class="est-name">'+i[r].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+i[r].objectId+'"></tbody></table></div>';for(c=0;c<i[r].establishmentSpecials.length;c++){var _,F=document.getElementById("myTable"+i[r].objectId);_=i[r].establishmentSpecials[c].Days_Of_Week.split(", ");for(var L="M",O="T",w="W",j="T",D="F",H="S",A="S",R=0;R<_.length;R++)"Monday"==_[R]?L=L.fontcolor("#E63594"):"Tuesday"==_[R]?O=O.fontcolor("#E63594"):"Wednesday"==_[R]?w=w.fontcolor("#E63594"):"Thursday"==_[R]?j=j.fontcolor("#E63594"):"Friday"==_[R]?D=D.fontcolor("#E63594"):"Saturday"==_[R]?H=H.fontcolor("#E63594"):"Sunday"==_[R]&&(A=A.fontcolor("#E63594"));addRowTopSpecial(F,("Drink"==_typeOfSpecial[0]?'<img class="cocktail-small-img" src="images/cocktail-small.png">':'<img class="hamburger-small-img" src="images/burger-big2.png">')+i[r].establishmentSpecials[c].Description,i[r].establishmentSpecials[c].objectId),addRowBottom(F,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(i[r].establishmentSpecials[c].Start_Time)+" - "+tConvert(i[r].establishmentSpecials[c].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+L+O+w+j+D+H+A+"</div>",i[r].establishmentSpecials[c].objectId),B++}document.getElementById("rpList").innerHTML+="<br>"}document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+B+"' matching "+_typeOfSpecial[0]+" specials"}if("block"==document.getElementById("rpGoogleMap").style.display){if(console.log("Map displayed"),useFilteredMarkers=!0,"establishment-page-map"==state)console.log("State: Display establishment map marker"),filteredMarkers=masterMarkers.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").innerHTML));else{filteredMarkers=masterMarkers,console.log(masterEstablishments),console.log(filteredMarkers);var W=[];for(r=0;r<filteredMarkers.length;r++)for(c=0;c<filteredMarkers[r].establishmentSpecials.length;c++){var N=[];if(filteredMarkers[r].establishmentSpecials[c].Days_Of_Week.includes(", ")){var G=filteredMarkers[r].establishmentSpecials[c].Days_Of_Week.split(", ");for(p=0,g=G.length;p<g;p++)N.push(G[p])}else N.push(filteredMarkers[r].establishmentSpecials[c].Days_Of_Week);for(u=0;u<e.length;u++)1==N.includes(e[u])&&W.push(filteredMarkers[r].establishmentSpecials[c].objectId)}console.log(W),e.length>=1&&W.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>W.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var P=60*t.substring(0,2)+ +t.substring(3,5),z=60*s.substring(0,2)+ +s.substring(3,5),U=[],x=[];for(r=0;r<filteredMarkers.length;r++)for(c=0;c<filteredMarkers[r].establishmentSpecials.length;c++){var V=filteredMarkers[r].establishmentSpecials[c].Start_Time,q=filteredMarkers[r].establishmentSpecials[c].End_Time;V=60*V.substring(0,2)+ +V.substring(3,5),(q=60*q.substring(0,2)+ +q.substring(3,5))>P&&V<z&&(U.push(filteredMarkers[r].establishmentSpecials[c]),x.push(filteredMarkers[r].establishmentSpecials[c].objectId))}x.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>x.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var X=[],J=[];for(r=0;r<filteredMarkers.length;r++){var Q=[];if(filteredMarkers[r].Cuisine_Type.includes(", ")){var K=filteredMarkers[r].Cuisine_Type.split(", ");for(p=0,g=K.length;p<g;p++)Q.push(K[p])}else Q.push(filteredMarkers[r].Cuisine_Type);for(u=0;u<a.length;u++)1==Q.includes(a[u])&&(J.push(filteredMarkers[r]),X.push(filteredMarkers[r].objectId))}console.log(J),console.log(a),console.log(X),a.length>=1&&(filteredMarkers=filteredMarkers.filter(e=>X.includes(e.objectId))),n.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>n.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]))}initMap()}document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowList(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect(),"establishment-page-map"==state?(state="establishment-page",console.log("State: "+state)):"establishment-page"==state?(state="filtered-list",console.log("State: "+state),applyFilters()):(state="filtered-list")&&console.log("State: "+state),document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowMap(){document.getElementById("rpList").style.display="none",document.getElementById("rpGoogleMap").style.display="block","filtered-list"==state&&(state="filtered-list-map",console.log("State: "+state)),"establishment-page"==state&&(state="establishment-page-map",console.log("State: "+state)),applyFilters(),document.getElementById("rpbtnList").style.backgroundColor="#d9d9d9",document.getElementById("rpBtnMap").style.backgroundColor="#E63594"}function onlyUnique(e,t,s){return s.indexOf(e)===t}function addCellTopEst(e,t,s){var l=document.createElement("td");l.innerHTML=t,l.colSpan=2,l.classList.add("cellTopSpecialCSS"),e.appendChild(l)}function addRowTopEst(e,t,s){var l=document.createElement("tr");l.id=s,addCellTopSpecial(l,t),e.appendChild(l)}function addCellTopSpecial(e,t,s){var l=document.createElement("td");l.innerHTML=t,l.colSpan=2,l.classList.add("cellTopSpecialCSS"),e.appendChild(l)}function addRowTopSpecial(e,t,s){var l=document.createElement("tr");l.id=s,addCellTopSpecial(l,t),e.appendChild(l)}function addCellTop(e,t,s){var l=document.createElement("td");l.innerHTML=t,l.colSpan=2,l.classList.add("cellTopCSS"),e.appendChild(l)}function addRowTop(e,t,s){var l=document.createElement("tr");l.id=s,addCellTop(l,t),e.appendChild(l)}function addCellBottom(e,t,s){var l=document.createElement("td");l.innerHTML=t,l.classList.add("cellBottomCSS"),e.appendChild(l)}function addRowBottom(e,t,s,l){var a=document.createElement("tr");a.id=l,addCellBottom(a,t),addCellBottom(a,s),e.appendChild(a)}function addCell(e,t,s){var l=document.createElement("td");l.innerHTML=t,l.classList.add("cellCSS"),e.appendChild(l)}function addRow(e,t,s,l){var a=document.createElement("tr");a.id=l,addCell(a,t),addCell(a,s),e.appendChild(a)}function addRowBottomCollapsible(e,t,s,l){var a=document.createElement("tr");a.id=l,a.classList.add("header"),addCellBottom(a,t),addCellBottom(a,s),e.appendChild(a)}function addRowBottomCollapsible2(e,t,s,l){var a=document.createElement("tr");a.id=l,a.classList.add("header"),addCellBottom(a,t),addCellBottom(a,s),e.appendChild(a)}function research(){initialSearch=!1,suburb=document.getElementById("researchInput").value,localStorage.setItem("usersSuburb",suburb),masterEstablishments=[],masterMarkers=[],pageOnLoad()}function tConvert(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function testing(){console.log(filteredMarkers),setMapOnAll(null)}function setMapOnAll(e){for(var t=0;t<filteredMarkers.length;t++)console.log(filteredMarkers[t].coords.lat),filteredMarkers.setMap(e)}function drinkFoodVisuals(e){"food"==e?(document.getElementById("tabDrink").style.backgroundColor="#888F91",document.getElementById("tabFood").style.backgroundColor="#E63594"):"drink"==e&&(document.getElementById("tabFood").style.backgroundColor="#888F91",document.getElementById("tabDrink").style.backgroundColor="#E63594")}document.addEventListener("DOMContentLoaded",function(){pageOnLoad()}),$(".header").click(function(){console.log("Hi"),$(this).nextUntil("tr.header").slideToggle(1e3)}),$(document).on("click",".header",function(){console.log("hi"),$(this).slideToggle(0)}),$(document).on("click","#viewEstablishmentPage",function(){document.getElementById("nav-bar").scrollIntoView();var e=$(this).attr("data-id");console.log(masterEstablishments);for(var t=document.getElementById("myTable"+e),s=0,l=masterEstablishments.length;s<l;s++)if(e==masterEstablishments[s].objectId){document.getElementById("rpList").innerHTML='<div class="establishment-wrapper"><img class="rpImage" src="'+masterEstablishments[s].Image+'"><br><span class="est-name">'+masterEstablishments[s].Name+'</span><hr class="est-name-underline"><br><br><br><div class="est-details"><div class="est-detail">'+masterEstablishments[s].Cuisine_Type+"</div>"+masterEstablishments[s].Address+"<br>"+masterEstablishments[s].Suburb+", "+masterEstablishments[s].Postcode+"<br>Google buisness link<br>Website link<br></div></div>",document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s+'"></tbody></table></div>';for(var a=[],n=0,i=t.rows.length;n<i;n++)a.push(t.rows[n].id),n++;console.log("Object IDs:"),console.log(a);var o=[],r=masterEstablishments[s];console.log("Establishment"),console.log(r);var c=[],d=0,m=r.establishmentSpecials.length;console.log("Establishment's number of specials: "+m);for(d=0;d<m;d++)c.push(r.establishmentSpecials[d]);console.log("Establishment's specials: "),console.log(c);for(var p=c,g=c,u={},b=["Breakfast Special","Lunch Special","Dinner Special","Happy Hour"],h=0;h<b.length;h++)u[b[h]]=h;var y=[];(y=p.filter(e=>!a.includes(e.objectId))).sort(function(e,t){return u[e.Category]-u[t.Category]||e.Start_Time.localeCompare(t.Start_Time)}),console.log("Sorted - Other establishment specials: "),console.log(y),(o=g.filter(e=>a.includes(e.objectId))).sort(function(e,t){return u[e.Category]-u[t.Category]||e.Start_Time.localeCompare(t.Start_Time)}),console.log("Sorted - establishment specials"),console.log(o);for(var f=0,S=y.length;f<S;f++)y[f].otherSpecials=void 0;y.length>0&&(y[0].otherSpecials="yes"),console.log("otherSpecials = undefined"),console.log(y);var E=[];E=o.concat(y);console.log(E);for(var v=0;v<E.length;v++){var k,I=document.getElementById("myTable"+s);k=E[v].Days_Of_Week.split(", ");for(var T,M="M",C="T",B="W",_="T",F="F",L="S",O="S",w=0;w<k.length;w++)"Monday"==k[w]?M=M.fontcolor("#E63594"):"Tuesday"==k[w]?C=C.fontcolor("#E63594"):"Wednesday"==k[w]?B=B.fontcolor("#E63594"):"Thursday"==k[w]?_=_.fontcolor("#E63594"):"Friday"==k[w]?F=F.fontcolor("#E63594"):"Saturday"==k[w]?L=L.fontcolor("#E63594"):"Sunday"==k[w]&&(O=O.fontcolor("#E63594"));T="Drink"==E[v].Type_Of_Special?'<img class="cocktail-small-img" src="images/cocktail-small.png">':'<img class="hamburger-small-img" src="images/burger-big2.png">',0==v?(addRowTop(I,"Specials matching your search criteria",E[v].objectId),addRowTopSpecial(I,T+E[v].Description,E[v].objectId),addRowBottom(I,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(E[v].Start_Time)+" - "+tConvert(E[v].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+M+C+B+_+F+L+O+"</div>",E[v].objectId)):"yes"==E[v].otherSpecials?(console.log(E[v].Description),addRowTop(I,"Other specials on offer",E[v].objectId),addRowTopSpecial(I,T+E[v].Description,E[v].objectId),addRowBottom(I,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(E[v].Start_Time)+" - "+tConvert(E[v].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+M+C+B+_+F+L+O+"</div>",E[v].objectId)):(addRowTopSpecial(I,T+E[v].Description,E[v].objectId),addRowBottom(I,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(E[v].Start_Time)+" - "+tConvert(E[v].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+M+C+B+_+F+L+O+"</div>",E[v].objectId))}document.getElementById("rpNumOfSpecialsFound").innerHTML=masterEstablishments[s].Name}state="establishment-page",console.log("State: "+state)});